This powershell script will get you info like vmid, vmname, ostype, skusize, public ip and export it to a csv file

You will need to have the latest Powershell installed and authenticate to Azure using Az-connect